<!DOCTYPE html>
<html lang="en" class="">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Djankrom District YAF - Account</title>

  <!-- Tailwind is included -->
  <link rel="stylesheet" href="stylesheets/main.css?v=1628755089081">

  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"/>
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png"/>
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png"/>

  <meta name="description" content="Djankrom District YAF - Account">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130795909-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-130795909-1');
  </script>
   <script
   src="https://code.jquery.com/jquery-3.7.0.js"
   integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM="
   crossorigin="anonymous"
 ></script>

</head>
<body>

<div id="app">

<nav id="navbar-main" class="navbar is-fixed-top">
  <div class="navbar-brand">
    <a class="navbar-item mobile-aside-button">
      <span class="icon"><i class="mdi mdi-forwardburger mdi-24px"></i></span>
    </a>
    <div class="navbar-item">
      <div class="control"><input placeholder="Search everywhere..." class="input"></div>
    </div>
  </div>
  <div class="navbar-brand is-right">
    <a class="navbar-item --jb-navbar-menu-toggle" data-target="navbar-menu">
      <span class="icon"><i class="mdi mdi-dots-vertical mdi-24px"></i></span>
    </a>
  </div>
  <div class="navbar-menu" id="navbar-menu">
    <div class="navbar-end">
      <div class="navbar-item dropdown has-divider has-user-avatar">
        <a class="navbar-link">
          <div class="user-avatar">
            <img src="images/profile.svg" class="rounded-full">
          </div>
          <div class="is-user-name"><span id="username"></span></div>
          <span class="icon"><i class="mdi mdi-chevron-down"></i></span>
        </a>
        <div class="navbar-dropdown">
          <a href="profile.html" class="navbar-item">
            <span class="icon"><i class="mdi mdi-account"></i></span>
            <span>Profile</span>
          </a>
          <a href="create-account.html" class="navbar-item">
            <span class="icon"><i class="mdi mdi-account-lock-outline"></i></span>
            <span>account</span>
          </a>
          <hr class="navbar-divider">
          <a href="#" class="navbar-item">
            <span class="icon"><i class="mdi mdi-logout"></i></span>
            <span id="logout">Log Out</span>
          </a>
        </div>
      </div>
      <a href="dashboard.html" class="navbar-item desktop-icon-only">
        <img src="images/yaf.jpeg" alt="YAF" class="rounded-full">
      </a>
    </div>
  </div>
</nav>

<aside class="aside is-placed-left is-expanded">
  <div class="aside-tools">
    <div>
      District <b class="font-black">YAF</b>
    </div>
  </div>
  <div class="menu is-menu-main">
    <p class="menu-label">Overview</p>
    <ul class="menu-list">
      <li class="active">
        <a href="dashboard.html">
          <span class="icon"><i class="mdi mdi-desktop-mac"></i></span>
          <span class="menu-item-label">Dashboard</span>
        </a>
      </li>
    </ul>
    <p class="menu-label">Info</p>
    <ul class="menu-list">
      <li class="--set-active-profile-html">
        <a href="profile.html">
          <span class="icon"><i class="mdi mdi-account-circle"></i></span>
          <span class="menu-item-label">Profile</span>
        </a>
      </li>
      <li class="--set-active-forms-html">
        <a href="entry.html">
          <span class="icon"><i class="mdi mdi-square-edit-outline"></i></span>
          <span class="menu-item-label">Add</span>
        </a>
      </li>
      <li id="account">
        <a href="create-account.html">
          <span class="icon"><i class="mdi mdi-account-lock-outline"></i></span>
          <span class="menu-item-label">Create account</span>
        </a>
      </li>
      <li>
        <a href="change-password.html">
          <span class="icon"><i class="mdi mdi-lock"></i></span>
          <span class="menu-item-label">Change password</span>
        </a>
      </li>
    </ul>
  </div>
</aside>

<section class="is-title-bar">
  <div class="flex flex-col md:flex-row items-center justify-between space-y-6 md:space-y-0">
    <ul>
      <li>Admin</li>
      <li>Create account</li>
    </ul>
  </div>
</section>

  <section class="section main-section">
    <div class="card mb-6">
        <header class="card-header">
          <p class="card-header-title">
            <span class="icon"><i class="mdi mdi-account-lock"></i></span>
            Create user account
          </p>
        </header>
        <div class="card-content">
          <form>
            <div class="field">
              <div class="field-body">
                <div class="field">
                  <div class="control icons-left icons-right">
                    <input class="input" type="text" placeholder="Firstname" name="firstname">
                    <span class="icon left"><i class="mdi mdi-account"></i></span>
                    <span style="display:none;" class="icon right" id="firstname-check">
                      <i class="mdi mdi-check"></i></span>
                  </div>
                  <p style="color:red; display:none;" class="help" id="firstname-error">
                    Firstname field is required
                  </p>
                </div>
                <div class="field">
                  <div class="control icons-left icons-right">
                    <input class="input" type="text" placeholder="Lastname" name="lastname">
                    <span class="icon left"><i class="mdi mdi-account"></i></span>
                    <span style="display:none;" class="icon right" id="lastname-check">
                      <i class="mdi mdi-check"></i></span>
                  </div>
                  <p style="color:red; display:none;" class="help" id="lastname-error">
                    Lastname field is required
                  </p>
                </div>
                <div class="field">
                  <div class="control icons-left icons-right">
                    <input class="input" type="email" placeholder="Email" name="email">
                    <span class="icon left"><i class="mdi mdi-mail"></i></span>
                    <span style="display:none;" class="icon right" id="email-check">
                      <i class="mdi mdi-check"></i></span>
                  </div>
                  <p style="color:red; display:none;" class="help" id="email-error">
                    Email field is required
                  </p>
                </div>
              </div>
            </div>
            <hr>
            <div class="field">
              <div class="control icons-left icons-right">
                <input class="input" type="password" placeholder="Password" name="password">
                <span class="icon left"><i class="mdi mdi-lock"></i></span>
                <span style="display:none;" class="icon right" id="password-check">
                  <i class="mdi mdi-check"></i></span>
              </div>
              <p style="color:red; display:none;" class="help" id="password-error">
                Password field is required
              </p>
            </div>
  
            <div class="field">
              <div class="control icons-left icons-right">
                <input class="input" type="password" placeholder="Confirm password" name="confirm-password">
                <span class="icon left"><i class="mdi mdi-lock"></i></span>
                <span style="display:none;" class="icon right" id="confirm-password-check">
                  <i class="mdi mdi-check"></i></span>
              </div>
              <p style="color:red; display:none;" class="help" id="confirm-password-error">
                Confirm password field is required
              </p>
              <p style="display:none; padding: 2% 0 0 25%;" id="statusMessage"></p>
            <hr>
  
            <div class="field grouped">
              <div class="control">
                <button type="submit" class="button green">
                  Register a user
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

  </section>

<footer class="footer">
  <div class="flex flex-col md:flex-row items-center justify-between space-y-3 md:space-y-0">
    <div class="flex items-center justify-start space-x-3">
      <div>
        Â© 2023, Djankrom District YAF
      </div>
    </div>
    
  </div>
</footer>

</div>

<script>
  /* Window loading*/
  $(window).on('load', () => {
    /* Get user data */
    const user = JSON.parse(localStorage.getItem('user'));
    $('#username').text(user.firstname);
    $('img').attr('alt', user.firstname);

    /* Check user role and hide create account */
    if (user.role !== 'admin')
        $('#account').hide();

  });

  /* Document ready */
  $(document).ready(function() {

    /* Form submission */
    $('form').submit((event) => {
      event.preventDefault();

      const firstname = $('input[name="firstname"]').val();
      const lastname = $('input[name="lastname"]').val();
      const email = $('input[name="email"]').val();
      const password = $('input[name="password"]').val();
      const confirmPassword = $('input[name="confirm-password"]').val();

      if (!firstname) {
        $('#firstname-error').show();
        $('#firstname-check').hide();
        return;
      } else {
        $('#firstname-error').hide();
        $('#firstname-check').show();
      }

      if (!lastname) {
        $('#lastname-error').show();
        $('#lastname-check').hide();
        return;
      } else {
        $('#lastname-error').hide();
        $('#lastname-check').show();
      }

      if (!email) {
        $('#email-error').show();
        $('#email-check').hide();
        return;
      } else {
        $('#email-error').hide();
        $('#email-check').show();
      }

      if (!password) {
        $('#password-error').show();
        $('#password-check').hide();
        return;
      } else {
        $('#password-error').hide();
        $('#password-check').show();
      }

      if (!confirmPassword) {
        $('#confirm-password-error').show();
        $('#confirm-password-check').hide();
        return;
      } else {
        $('#confirm-password-error').hide();
        $('#confirm-password-check').show();
      }

      if (password !== confirmPassword) {
        $('#statusMessage').css('color', 'red');
        $('#statusMessage').show();
        $('#statusMessage').text('Password does not match');
        return;
      }

      const data = {
        firstname,
        lastname,
        email,
        password,
        role: 'executive',
      };
      $(':submit').text('Loading...');

      $.ajax({
          type: 'POST',
          url: '/api/v1/users/register',
          data,
          dataType: 'json',
          headers: { Authorization: `Bearer ${localStorage.getItem('token')}` },
          success: (response) => {
            $('#statusMessage').hide();
            $(':submit').text('Register a user');

            const { status, message } = response;

            if (status === 'success') {
              $('#statusMessage').css('color', 'green');
              $('#statusMessage').show();
              $('#statusMessage').text(message);
              $('input[name=firstname]').val('');
              $('input[name=lastname]').val('');
              $('input[name=email]').val('');
              $('input[name=password]').val('');
              $('input[name=confirm-password]').val('');
              $('#firstname-check').hide();
              $('#lastname-check').hide();
              $('#email-check').hide();
              $('#password-check').hide();
              $('#confirm-password-check').hide();
            } else {
              $('#statusMessage').css('color', 'red');
              $('#statusMessage').show();
              $('#statusMessage').text(message);
            }
          },
      });


    });

    /* Handling logout */
    $('#logout').click((event) => {
      event.preventDefault();
      localStorage.removeItem('user');
      localStorage.removeItem('token');
      localStorage.removeItem('district-metadata');
      localStorage.removeItem('branch-metadata');
      window.location.href = '/';
    });

  });

</script>

<!-- Scripts below are for demo only -->
<script type="text/javascript" src="javascripts/main.min.js?v=1628755089081"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>

<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '658339141622648');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=658339141622648&ev=PageView&noscript=1"/></noscript>

<!-- Icons below are for demo only. Feel free to use any icon pack. Docs: https://bulma.io/documentation/elements/icon/ -->
<link rel="stylesheet" href="https://cdn.materialdesignicons.com/4.9.95/css/materialdesignicons.min.css">

</body>
</html>
